"use strict";(globalThis.webpackChunkmy_book=globalThis.webpackChunkmy_book||[]).push([[2416],{2111(e,n,s){s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"ros2-packages-python","title":"Building ROS 2 Packages with Python","description":"In ROS 2, code is organized into packages. A package is a directory containing your source code (e.g., Python scripts), launch files, configuration files, and a package.xml file that provides metadata about the package. The build system used by ROS 2 is called colcon.","source":"@site/docs/08-ros2-packages-python.md","sourceDirName":".","slug":"/ros2-packages-python","permalink":"/my-book/docs/ros2-packages-python","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Services and Actions","permalink":"/my-book/docs/ros2-services-actions"},"next":{"title":"ROS 2 Launch Files and Parameter Management","permalink":"/my-book/docs/ros2-launch-files-parameters"}}');var r=s(2540),o=s(3023);const c={sidebar_position:8},a="Building ROS 2 Packages with Python",t={},l=[{value:"The ROS 2 Workspace",id:"the-ros-2-workspace",level:2},{value:"Creating a ROS 2 Package with Python",id:"creating-a-ros-2-package-with-python",level:2},{value:"Key Files in a Python Package",id:"key-files-in-a-python-package",level:2},{value:"<code>package.xml</code>",id:"packagexml",level:3},{value:"<code>setup.py</code>",id:"setuppy",level:3},{value:"Your Python Node (<code>my_publisher.py</code>)",id:"your-python-node-my_publisherpy",level:3},{value:"Building and Sourcing Your Package",id:"building-and-sourcing-your-package",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"building-ros-2-packages-with-python",children:"Building ROS 2 Packages with Python"})}),"\n",(0,r.jsxs)(n.p,{children:["In ROS 2, code is organized into ",(0,r.jsx)(n.strong,{children:"packages"}),". A package is a directory containing your source code (e.g., Python scripts), launch files, configuration files, and a ",(0,r.jsx)(n.code,{children:"package.xml"})," file that provides metadata about the package. The build system used by ROS 2 is called ",(0,r.jsx)(n.strong,{children:"colcon"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"This guide will walk you through the standard structure of a Python-based ROS 2 package and the process of building it."}),"\n",(0,r.jsx)(n.h2,{id:"the-ros-2-workspace",children:"The ROS 2 Workspace"}),"\n",(0,r.jsxs)(n.p,{children:["Before creating a package, you need a ",(0,r.jsx)(n.strong,{children:"workspace"}),". A workspace is a directory where you will store and build your ROS 2 packages."]}),"\n",(0,r.jsx)(n.p,{children:"A typical workspace structure looks like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ros2_ws/\r\n\u251c\u2500\u2500 src/      # Source space: where you put your package source code\r\n\u251c\u2500\u2500 build/    # Build space: where colcon stores intermediate build files\r\n\u251c\u2500\u2500 install/  # Install space: where the final package files are installed\r\n\u2514\u2500\u2500 log/      # Log space: where colcon stores log information\n"})}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-ros-2-package-with-python",children:"Creating a ROS 2 Package with Python"}),"\n",(0,r.jsxs)(n.p,{children:["You can create a new package using the ",(0,r.jsx)(n.code,{children:"ros2 pkg create"})," command. Let's create a simple publisher/subscriber package."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Navigate to your workspace's ",(0,r.jsx)(n.code,{children:"src"})," directory:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run the package creation command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 pkg create --build-type ament_python --node-name my_publisher my_python_pkg\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--build-type ament_python"}),": Specifies that this is a Python package."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--node-name my_publisher"}),": Automatically creates a basic executable script for a node named ",(0,r.jsx)(n.code,{children:"my_publisher"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"my_python_pkg"}),": The name of your new package."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This will generate a directory named ",(0,r.jsx)(n.code,{children:"my_python_pkg"})," with the following structure:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"my_python_pkg/\r\n\u251c\u2500\u2500 my_python_pkg/\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u2514\u2500\u2500 my_publisher.py   # Your Python node script\r\n\u251c\u2500\u2500 resource/\r\n\u2502   \u2514\u2500\u2500 my_python_pkg\r\n\u251c\u2500\u2500 test/\r\n\u2502   \u251c\u2500\u2500 test_copyright.py\r\n\u2502   \u251c\u2500\u2500 test_flake8.py\r\n\u2502   \u2514\u2500\u2500 test_pep257.py\r\n\u251c\u2500\u2500 package.xml           # Package manifest\r\n\u2514\u2500\u2500 setup.py              # Python package setup script\r\n\u2514\u2500\u2500 setup.cfg\n"})}),"\n",(0,r.jsx)(n.h2,{id:"key-files-in-a-python-package",children:"Key Files in a Python Package"}),"\n",(0,r.jsx)(n.h3,{id:"packagexml",children:(0,r.jsx)(n.code,{children:"package.xml"})}),"\n",(0,r.jsx)(n.p,{children:"This file contains metadata about your package, such as its name, version, author, and dependencies. When you create a package, you need to add its dependencies here. For a simple Python publisher, you would add:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<depend>rclpy</depend>\r\n<depend>std_msgs</depend>\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"rclpy"})," is the ROS 2 client library for Python, and ",(0,r.jsx)(n.code,{children:"std_msgs"})," contains standard message types."]}),"\n",(0,r.jsx)(n.h3,{id:"setuppy",children:(0,r.jsx)(n.code,{children:"setup.py"})}),"\n",(0,r.jsxs)(n.p,{children:["This is the build script for your Python package. It tells ",(0,r.jsx)(n.code,{children:"colcon"})," how to install your package and where to find its executable scripts (your nodes). A crucial part of this file is the ",(0,r.jsx)(n.code,{children:"entry_points"})," dictionary within the ",(0,r.jsx)(n.code,{children:"setup()"})," function."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"entry_points={\r\n    'console_scripts': [\r\n        'my_publisher = my_python_pkg.my_publisher:main',\r\n    ],\r\n},\n"})}),"\n",(0,r.jsxs)(n.p,{children:['This line creates a "console script" or executable named ',(0,r.jsx)(n.code,{children:"my_publisher"}),". When you run this script, it will execute the ",(0,r.jsx)(n.code,{children:"main"})," function located in the ",(0,r.jsx)(n.code,{children:"my_publisher.py"})," file inside your ",(0,r.jsx)(n.code,{children:"my_python_pkg"})," module."]}),"\n",(0,r.jsxs)(n.h3,{id:"your-python-node-my_publisherpy",children:["Your Python Node (",(0,r.jsx)(n.code,{children:"my_publisher.py"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["This is where you write the logic for your ROS 2 node. The template will create a minimal class structure for you to fill in. You will import ",(0,r.jsx)(n.code,{children:"rclpy"}),", message types, and then define your publisher, subscriber, service, or action clients/servers within your node's class."]}),"\n",(0,r.jsx)(n.h2,{id:"building-and-sourcing-your-package",children:"Building and Sourcing Your Package"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Build the Package"}),": From the root of your workspace (",(0,r.jsx)(n.code,{children:"~/ros2_ws"}),"), run the ",(0,r.jsx)(n.code,{children:"colcon build"})," command:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"colcon build\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"colcon"})," will find all the packages in your ",(0,r.jsx)(n.code,{children:"src"})," directory, resolve their dependencies, and build them, placing the output in the ",(0,r.jsx)(n.code,{children:"build"})," and ",(0,r.jsx)(n.code,{children:"install"})," directories."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source the Workspace"}),': After a successful build, you need to "source" the ',(0,r.jsx)(n.code,{children:"setup.bash"})," file in the ",(0,r.jsx)(n.code,{children:"install"})," directory. This script adds your newly built package to your shell's environment, allowing ROS 2 to find your nodes."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"source ~/ros2_ws/install/setup.bash\n"})}),"\n",(0,r.jsx)(n.p,{children:"You must do this in every new terminal you open."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Run Your Node"}),": Now you can run your node using ",(0,r.jsx)(n.code,{children:"ros2 run"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 run my_python_pkg my_publisher\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This workflow\u2014create, code, build, source, run\u2014is the fundamental development cycle for creating any ROS 2 application."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},3023(e,n,s){s.d(n,{R:()=>c,x:()=>a});var i=s(3696);const r={},o=i.createContext(r);function c(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);